<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>GALAXIA Launcher</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html,body{margin:0;height:100%;background:#050510;color:white;font-family:system-ui;overflow:hidden}
.page{display:none;height:100%}
.page.active{display:flex}
button{background:#1e90ff;border:none;color:white;padding:8px 12px;border-radius:8px;cursor:pointer}
input{background:#111;border:none;color:white;padding:8px;border-radius:8px}
header{display:flex;gap:10px;align-items:center;margin-bottom:10px}
#launcher,#installed,#scanner{flex-direction:column;padding:20px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:15px}
.card{background:#14142a;border-radius:12px;padding:10px;cursor:pointer}
.card:hover{background:#1a1a35}
#gamePage{flex-direction:column}
#bar{background:#0b0b18;height:46px;display:flex;align-items:center;gap:10px;padding:0 10px}
#gameContainer{flex:1;background:black}
iframe{width:100%;height:100%;border:none}
nav{display:flex;gap:10px;margin-bottom:10px}
</style>
</head>

<body>

<!-- ========== LAUNCHER ========== -->
<div id="launcher" class="page active">
  <header>
    <h2>üåå GALAXIA</h2>
  </header>
  <nav>
    <button onclick="show('installed')">Installed</button>
    <button onclick="show('scanner')">Game Scanner</button>
    <button onclick="installGame()">Install Game</button>
  </nav>
  <p>Select a section above.</p>
</div>

<!-- ========== INSTALLED ========== -->
<div id="installed" class="page">
  <header>
    <button onclick="show('launcher')">‚Üê Back</button>
    <h3>Installed Games</h3>
  </header>
  <div id="installedGrid" class="grid"></div>
</div>

<!-- ========== GAME SCANNER V1 ========== -->
<div id="scanner" class="page">
  <header>
    <button onclick="show('launcher')">‚Üê Back</button>
    <h3>Game Scanner v1</h3>
  </header>
  <input id="scanInput" placeholder="Search FPS / Unity / Shooter">
  <div id="scanResults" class="grid"></div>
</div>

<!-- ========== GAME PAGE ========== -->
<div id="gamePage" class="page">
  <div id="bar">
    <button onclick="exitGame()">‚Üê Exit</button>
    <button onclick="fullscreen()">Fullscreen</button>
  </div>
  <div id="gameContainer"></div>
</div>

<script>
/* ===== NAV ===== */
const pages=["launcher","installed","scanner","gamePage"];
function show(id){
  pages.forEach(p=>document.getElementById(p).classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* ===== STORAGE ===== */
let installedGames=JSON.parse(localStorage.getItem("galaxia_games")||"[]");

function save(){localStorage.setItem("galaxia_games",JSON.stringify(installedGames));}

/* ===== INSTALL REAL WEB GAME ===== */
function installGame(){
  const input=document.createElement("input");
  input.type="file";
  input.webkitdirectory=true;
  input.onchange=()=>{
    const files=[...input.files];
    const entry=files.find(f=>f.name==="index.html");
    if(!entry)return alert("Folder must contain index.html");
    const url=URL.createObjectURL(entry);
    installedGames.push({name:entry.webkitRelativePath.split("/")[0],url});
    save();
    renderInstalled();
    show("installed");
  };
  input.click();
}

/* ===== INSTALLED ===== */
function renderInstalled(){
  const grid=document.getElementById("installedGrid");
  grid.innerHTML="";
  installedGames.forEach(g=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=g.name;
    c.onclick=()=>launch(g.url);
    grid.appendChild(c);
  });
}
renderInstalled();

/* ===== SCANNER V1 (CURATED REAL GAMES) ===== */
const catalog=[
  {name:"Krunker",url:"https://krunker.io"},
  {name:"Shell Shockers",url:"https://shellshock.io"},
  {name:"ThreeJS FPS",url:"https://mrdoob.github.io/three.js/examples/games_fps.html"},
  {name:"Unity FPS Sample",url:"https://unity-webgl-builds.github.io/fps-sample/"}
];

document.getElementById("scanInput").oninput=e=>{
  const q=e.target.value.toLowerCase();
  const res=document.getElementById("scanResults");
  res.innerHTML="";
  catalog.filter(g=>g.name.toLowerCase().includes(q)).forEach(g=>{
    const c=document.createElement("div");
    c.className="card";
    c.innerHTML=g.name;
    c.onclick=()=>launch(g.url);
    res.appendChild(c);
  });
};

/* ===== GAME ===== */
const gameContainer=document.getElementById("gameContainer");
function launch(url){
  show("gamePage");
  gameContainer.innerHTML=`<iframe src="${url}" allow="fullscreen; gamepad"></iframe>`;
}
function exitGame(){
  if(document.fullscreenElement)document.exitFullscreen();
  gameContainer.innerHTML="";
  show("launcher");
}
function fullscreen(){
  if(!document.fullscreenElement)gameContainer.requestFullscreen();
  else document.exitFullscreen();
}

/* ===== CONTROLLER ===== */
window.addEventListener("gamepadconnected",e=>{
  console.log("Controller:",e.gamepad.id);
});
</script>

</body>
</html>
